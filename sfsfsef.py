#!/usr/bin/env python
# coding: utf-8

# <div style="border:solid green 2px; padding: 20px">
# <b>–°–µ—Ä–≥–µ–π, –ø—Ä–∏–≤–µ—Ç!</b>
# 
# –ú–µ–Ω—è –∑–æ–≤—É—Ç –ï–≤–≥–µ–Ω–∏–π –î–∞—â–µ–Ω–∫–æ, –∏ —è –±—É–¥—É –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç. –ü—Ä–µ–¥–ª–∞–≥–∞—é –æ–±—â–∞—Ç—å—Å—è –Ω–∞ ¬´—Ç—ã¬ª üòä –ù–æ –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ —É–¥–æ–±–Ω–æ - –¥–∞–π –∑–Ω–∞—Ç—å, –∏ –º—ã –ø–µ—Ä–µ–π–¥–µ–º –Ω–∞ "–≤—ã".¬†
# 
# –ú–æ—è –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî –Ω–µ —É–∫–∞–∑–∞—Ç—å –Ω–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ç–æ–±–æ—é –æ—à–∏–±–∫–∏, –∞ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º –æ–ø—ã—Ç–æ–º –∏ –ø–æ–º–æ—á—å —Ç–µ–±–µ —Å—Ç–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–º –¥–∞–Ω–Ω—ã—Ö. –¢—ã —É–∂–µ –ø—Ä–æ–¥–µ–ª–∞–ª –±–æ–ª—å—à—É—é —Ä–∞–±–æ—Ç—É –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º, –Ω–æ –¥–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º –µ–≥–æ –µ—â–µ –ª—É—á—à–µ. –ù–∏–∂–µ —Ç—ã –Ω–∞–π–¥–µ—à—å –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ - –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–π, –Ω–µ –∏–∑–º–µ–Ω—è–π –∏ –Ω–µ —É–¥–∞–ª—è–π –∏—Ö. –Ø –±—É–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ü–≤–µ—Ç–æ–≤—É—é —Ä–∞–∑–º–µ—Ç–∫—É:
# 
# <div class="alert alert-danger">
# <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b> –¢–∞–∫ –≤—ã–¥–µ–ª–µ–Ω—ã —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è. –ë–µ–∑ –∏—Ö –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–µ–∫—Ç –Ω–µ –±—É–¥–µ—Ç –ø—Ä–∏–Ω—è—Ç. </div>
# 
# <div class="alert alert-warning">
# <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b> –¢–∞–∫ –≤—ã–¥–µ–ª–µ–Ω—ã –Ω–µ–±–æ–ª—å—à–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è. –û–¥–Ω–∞-–¥–≤–∞ —Ç–∞–∫–∏—Ö –∑–∞–º–µ—á–∞–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–µ –¥–æ–ø—É—Å—Ç–∏–º—ã, –Ω–æ –µ—Å–ª–∏ –∏—Ö –±—É–¥–µ—Ç –±–æ–ª—å—à–µ - —Ç–µ–±–µ –±—É–¥–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–Ω–µ—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è. –≠—Ç–æ –∫–∞–∫ —Ç–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –ø—Ä–∏ –ø—Ä–∏–µ–º–µ –Ω–∞ —Ä–∞–±–æ—Ç—É: –æ—á–µ–Ω—å –º–Ω–æ–≥–æ –º–µ–ª–∫–∏—Ö –æ—à–∏–±–æ–∫ –º–æ–≥—É—Ç —Å—Ç–∞—Ç—å –ø—Ä–∏—á–∏–Ω–æ–π –æ—Ç–∫–∞–∑–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç—É. 
# 
# </div>
# 
# <div class="alert alert-success">
# <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b> –¢–∞–∫ —è –≤—ã–¥–µ–ª—è—é –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.</div>
# 
# –î–∞–≤–∞–π —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º –≤ –¥–∏–∞–ª–æ–≥–µ: –µ—Å–ª–∏ —Ç—ã —á—Ç–æ-—Ç–æ –º–µ–Ω—è–µ—à—å –≤ –ø—Ä–æ–µ–∫—Ç–µ –∏–ª–∏ –æ—Ç–≤–µ—á–∞–µ—à—å –Ω–∞ –º–æ–∏ –∫–æ–º–º–µ–Ω–∞—Ç—Ä–∏ ‚Äî –ø–∏—à–∏ –æ–± —ç—Ç–æ–º. –ú–Ω–µ –±—É–¥–µ—Ç –ª–µ–≥—á–µ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –µ—Å–ª–∏ —Ç—ã –≤—ã–¥–µ–ª–∏—à—å —Å–≤–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:
# <div class="alert alert-info"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ù–∞–ø—Ä–∏–º–µ—Ä, –≤–æ—Ç —Ç–∞–∫.</div>
# 
# –í—Å—ë —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–µ–µ. 

# # –†—ã–Ω–æ–∫ –∑–∞–≤–µ–¥–µ–Ω–∏–π –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –ú–æ—Å–∫–≤—ã

# –í—ã —Ä–µ—à–∏–ª–∏ –æ—Ç–∫—Ä—ã—Ç—å –Ω–µ–±–æ–ª—å—à–æ–µ –∫–∞—Ñ–µ –≤ –ú–æ—Å–∫–≤–µ. –û–Ω–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ ‚Äî –≥–æ—Å—Ç–µ–π –¥–æ–ª–∂–Ω—ã –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å —Ä–æ–±–æ—Ç—ã. –ü—Ä–æ–µ–∫—Ç –º–Ω–æ–≥–æ–æ–±–µ—â–∞—é—â–∏–π, –Ω–æ –¥–æ—Ä–æ–≥–æ–π. –í–º–µ—Å—Ç–µ —Å –ø–∞—Ä—Ç–Ω—ë—Ä–∞–º–∏ –≤—ã —Ä–µ—à–∏–ª–∏—Å—å –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞–º. –ò—Ö –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç —Ç–µ–∫—É—â–µ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–µ–ª –Ω–∞ —Ä—ã–Ω–∫–µ ‚Äî —Å–º–æ–∂–µ—Ç–µ –ª–∏ –≤—ã —Å–Ω–∏—Å–∫–∞—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –Ω–∞ –¥–æ–ª–≥–æ–µ –≤—Ä–µ–º—è, –∫–æ–≥–¥–∞ –≤—Å–µ –∑–µ–≤–∞–∫–∏ –Ω–∞—Å–º–æ—Ç—Ä—è—Ç—Å—è –Ω–∞ —Ä–æ–±–æ—Ç–æ–≤-–æ—Ñ–∏—Ü–∏–∞–Ω—Ç–æ–≤?
# 
# –í—ã ‚Äî –≥—É—Ä—É –∞–Ω–∞–ª–∏—Ç–∏–∫–∏, –∏ –ø–∞—Ä—Ç–Ω—ë—Ä—ã –ø—Ä–æ—Å—è—Ç –≤–∞—Å –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ä—ã–Ω–∫–∞. –£ –≤–∞—Å –µ—Å—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –∑–∞–≤–µ–¥–µ–Ω–∏—è—Ö –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –≤ –ú–æ—Å–∫–≤–µ.

# In[2]:


import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np
from numpy import median
from scipy import stats as st
import warnings
import datetime
import plotly.express as px 
import plotly.graph_objs as go
from plotly.offline import iplot
import requests
import re
from urllib.request import Request, urlopen

warnings.filterwarnings('ignore')


# ## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
# 0. [–ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –¥–∞–Ω–Ω—ã–º–∏](#0)
# 1. [–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –≤–∏–¥–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É](#1) <br>
# 2. [–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –∏ –Ω–µ—Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É](#2) <br>
# 3. [–î–ª—è –∫–∞–∫–æ–≥–æ –≤–∏–¥–∞ –æ–±—ä–µ–∫—Ç–∞ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ —Å–µ—Ç–µ–≤–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ?](#3) <br>
# 4. [–ß—Ç–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π: –º–Ω–æ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π —Å –Ω–µ–±–æ–ª—å—à–∏–º —á–∏—Å–ª–æ–º –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç –≤ –∫–∞–∂–¥–æ–º –∏–ª–∏ –º–∞–ª–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç?](#4) <br>
# 5. [–ö–∞–∫–æ–π –≤–∏–¥ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º —Å–∞–º–æ–µ –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç?](5) <br>
# 6. [–ì—Ä–∞—Ñ–∏–∫ —Ç–æ–ø-10 —É–ª–∏—Ü –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ–±—ä–µ–∫—Ç–æ–≤ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è](#6) <br>
# 7. [–†–µ–π—Ç–∏–Ω–≥ –∑–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥ (2012-2016)](#7) <br>
# 8. [–£–ª–∏—Ü—ã —Å –æ–¥–Ω–∏–º –æ–±—ä–µ–∫—Ç–æ–º –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è](#8) <br>
# 9. [–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç –¥–ª—è —É–ª–∏—Ü —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ–±—ä–µ–∫—Ç–æ–≤](#9) <br>
# 10. [–í—ã–≤–æ–¥](#10) <br>

# <div class="alert alert-success">
# <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
# 
# –ó–¥–æ—Ä–æ–≤–æ, –∫–æ–≥–¥–∞ –µ—Å—Ç—å –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ —Å–∞–º –ø—Ä–æ–µ–∫—Ç, –∫–∞–∂–¥—ã–π —Å–º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–µ–µ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å —Ç–µ–º –æ —á–µ–º —Å–∞–º –ø—Ä–æ–µ–∫—Ç üëçüòä
# 
# </div>

# <a id="0"></a>
# ## 0. –ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –¥–∞–Ω–Ω—ã–º–∏

# #### –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
# –¢–∞–±–ª–∏—Ü–∞ df:
# * id ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ–±—ä–µ–∫—Ç–∞;
# * object_name ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è;
# * chain ‚Äî —Å–µ—Ç–µ–≤–æ–π —Ä–µ—Å—Ç–æ—Ä–∞–Ω;
# * object_type ‚Äî —Ç–∏–ø –æ–±—ä–µ–∫—Ç–∞ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è;
# * address ‚Äî –∞–¥—Ä–µ—Å;
# * number ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç.

# In[3]:


df = pd.read_csv("/datasets/rest_data.csv")


# In[3]:


df.head()


# In[4]:


df.info()


# In[5]:


df.duplicated().sum()


# In[6]:


df.isna().sum()


# –ü—Ä–æ–ø—É—Å–∫–æ–≤ –∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–µ—Ç. –ü–µ—Ä–µ–π–¥—ë–º –∫ –∞–Ω–∞–ª–∏–∑—É.

# # –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

# <a id="1"></a>
# ### 1. –ò—Å—Å–ª–µ–¥—É–π—Ç–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –≤–∏–¥–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É. –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫.

# In[8]:


df['object_type'].value_counts()


# In[9]:


object_type = df['object_type']
fig = go.Figure(data=[go.Pie(labels=object_type)])
fig.update_layout(title_text="–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –≤–∏–¥–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É")
fig.show()


# –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –≤ –ú–æ—Å–∫–≤–µ - –∫–∞—Ñ–µ (40%). –ó–∞ –Ω–∏–º–∏ –∏–¥—É—Ç —Å—Ç–æ–ª–æ–≤—ã–µ (17%), —Ä–µ—Å—Ç–æ—Ä–∞–Ω (15%), –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è (13%).

# <div class="alert alert-success">
# <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
# 
# –û—Ç–ª–∏—á–Ω—ã–π –∏ –Ω–∞–≥–ª—è–¥–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ üëç
#     
# –ó–¥–æ—Ä–æ–≤–æ, –∫–æ–≥–¥–∞ –æ–Ω –ø–æ–¥–ø–∏—Å–∞–Ω. –¢–∞–∫ –±—ã—Å—Ç—Ä–µ–µ –ø–æ–Ω—è—Ç—å –æ —á–µ–º –∏–¥—ë—Ç —Ä–µ—á—å –Ω–∞ –Ω—ë–º.
#     
# </div>

# <a id="2"></a>
# ### 2. –ò—Å—Å–ª–µ–¥—É–π—Ç–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –∏ –Ω–µ—Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É. –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫.

# In[10]:


df['chain'].value_counts()


# In[11]:


chain = df['chain']
fig = go.Figure(data=[go.Pie(labels=chain)])
fig.update_layout(title_text="–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –∏ –Ω–µ—Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É")
fig.show()


# –ü–æ–¥–∞–≤–ª—è—é—â–µ–µ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π - –Ω–µ—Å–µ—Ç–µ–≤—ã–µ (81%)

# <div class="alert alert-success">
# <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
# 
# –ù–∞ –ø–µ—Ä–≤—ã–π –≤–∑–≥–ª—è–¥ —Ç–∞–∫ –∏ –Ω–µ —Å–∫–∞–∂–µ—à—å, —á—Ç–æ –Ω–µ—Å–µ—Ç–µ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –±–æ–ª—å—à–µ. 
#     
# –•–æ—Ä–æ—à–æ, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏ —ç—Ç–æ —Å –ø–æ–º–æ—â—å—é –Ω–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
#     
# </div>

# <a id="3"></a>
# ### 3. –î–ª—è –∫–∞–∫–æ–≥–æ –≤–∏–¥–∞ –æ–±—ä–µ–∫—Ç–∞ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ —Å–µ—Ç–µ–≤–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ?

# In[12]:


df1 = df.groupby(by='object_type')['chain'].value_counts().to_frame()
df1


# In[13]:


df.head(1)


# In[14]:


fig = plt.figure() # Create matplotlib figure

ax = fig.add_subplot(111) # Create matplotlib axes
# ax2 = ax.twinx() # Create another axes that shares the same x-axis as ax.


width = 0.35

df.groupby(by='object_type')['chain'].value_counts().plot(kind='bar', ax=ax, width=width, position=1, figsize=(10, 8))
# df.groupby(by='–°—É–¥')['–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–æ'].mean().plot(kind='bar', color='darkgray', ax=ax, width=width, position=0)
# legend = ['–ü–æ—Å—Ç—É–ø–∏–ª–æ –¥–µ–ª', '–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–æ –¥–µ–ª']
# plt.legend(legend)
plt.title('–°–µ—Ç—å - –¥–∞/–Ω–µ—Ç')
plt.xticks(rotation=70)


plt.show()


# In[15]:


object_type = df[df['chain'] == '–¥–∞']['object_type']
fig = go.Figure(data=[go.Pie(labels=object_type)])
fig.update_layout(title_text="–§–æ—Ä–º–∞—Ç —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π")
fig.show()


# <div class="alert alert-success">
# <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
# 
# –û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ —É –Ω–∞—Å –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è.
#     
# –≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –º—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –∏—Ö –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è. –ò —Å –ø–æ–º–æ—â—å—é —ç—Ç–æ–≥–æ –ø–æ–≤—ã—Å–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é —Å–≤–æ–µ–≥–æ –∫–æ–¥–∞ –∏ –ø—Ä–µ–∑–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ –≤ —Ü–µ–ª–æ–º.
#     
# –¢–æ –µ—Å—Ç—å –º—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å "–æ–±—ë—Ä—Ç–∫–∏" —Å –º–µ—Ç–æ–¥–∞–º–∏, –∏ –≤ —Ñ—É–Ω–∫—Ü–∏—é –±—É–¥–µ–º –ø–æ–¥–∞–≤–∞—Ç—å –Ω—É–∂–Ω—ã–µ –ø–µ—Ä–º–µ–Ω–Ω—ã–µ: 
#     
# - –¥–∞—Ç–∞—Å–µ—Ç
# - –ø–æ–¥–ø–∏—Å–∏ –≥—Ä–∞—Ñ–∏–∫–∞ –∏ –æ—Å–µ–π
# - –∏ –ø—Ä–æ—á–∏–µ –ª—é–±—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
#     
# </div>

# –ß–∞—â–µ –≤—Å–µ–≥–æ —Å–µ—Ç–µ–≤—ã–º–∏ —è–≤–ª—è—é—Ç—Å—è –∫–∞—Ñ–µ, –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã.

# <a id="4"></a>
# ### 4. –ß—Ç–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π: –º–Ω–æ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π —Å –Ω–µ–±–æ–ª—å—à–∏–º —á–∏—Å–ª–æ–º –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç –≤ –∫–∞–∂–¥–æ–º –∏–ª–∏ –º–∞–ª–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç?

# –ü–æ–ø—Ä–æ–±—É–µ–º —É–≤–∏–¥–µ—Ç—å —á—Ç–æ-—Ç–æ –Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º–µ —Ä–∞—Å—Å–µ—è–Ω–∏—è.

# In[16]:


fig = px.scatter(df, x = 'number', color = 'chain',
                 title = '–°–µ—Ç–µ–≤—ã–µ/–Ω–µ—Å–µ—Ç–µ–≤—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è –∏ –∫–æ–ª-–≤–æ –º–µ—Å—Ç –≤ –Ω–∏—Ö')
fig.show()


# –°–¥–µ–ª–∞—Ç—å –æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã–µ –≤—ã–≤–æ–¥—ã –ø–æ —ç—Ç–æ–º—É –≥—Ä–∞—Ñ–∏–∫—É —Å–ª–æ–∂–Ω–æ. –û–±—Ä–∞—Ç–∏–º—Å—è –∫ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–µ.

# <div class="alert alert-success">
# <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
# 
# –ö–ª–∞—Å—Å–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∞ üòä
#     
# </div>

# In[17]:


fig = px.histogram(df[df['chain']== '–¥–∞'], x="number", title='–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Å—Ç –≤ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏—è—Ö')
fig.update_layout(xaxis_title="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç", yaxis_title="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π")
fig.show()


# –î–ª—è —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –∑–∞–≤–µ–¥–µ–Ω–∏–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ –º–Ω–æ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π —Å –Ω–µ–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç.

# <div class="alert alert-success">
# <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
# 
# –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –∏ –∫–ª–∞—Å—Å–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫.
#     
# –í —Ç–æ–º —á–∏—Å–ª–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π  `boxplot`
#     
# </div>

# <a id="5"></a>
# ### 5. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∏–¥–∞ –æ–±—ä–µ–∫—Ç–∞ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –æ–ø–∏—à–∏—Ç–µ —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç. –ö–∞–∫–æ–π –≤–∏–¥ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º —Å–∞–º–æ–µ –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç? –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫–∏.

# In[17]:


# fig = px.histogram(df[df['object_type']== '–∫–∞—Ñ–µ'], x="number", , title='–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Å—Ç –≤ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏—è—Ö')
# fig.show()


# In[18]:


# print('–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç –≤ –∫–∞—Ñ–µ:', df[df['object_type']== '–∫–∞—Ñ–µ']['number'].mean())


# In[18]:


df1 = df.pivot_table(['number'], ['object_type'],aggfunc='mean').sort_values(by='number', ascending=False)
df1


# In[19]:


df1.reset_index(level=0, inplace=True)
df1


# In[20]:


fig = go.Figure(data=[go.Pie(labels=df1['object_type'], values=df1['number'])])
fig.update_layout(title_text="–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç")
fig.show()


# –ë–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç, –ø–æ –Ω–∞—à–∏–º –¥–∞–Ω–Ω—ã–º, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç —Å—Ç–æ–ª–æ–≤—ã–µ (32%), —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã (24%) –∏ –±—É—Ñ–µ—Ç—ã (13%).

# <div class="alert alert-success">
# <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
# 
# –î—É–º–∞—é –º—ã –∏ —Ç–∞–∫ –∑–Ω–∞–ª–∏, —á—Ç–æ —Å—Ç–æ–ª–æ–≤–∞—è –±—É–¥–µ—Ç –Ω–∞ –ø–µ—Ä–≤–æ–º –º–µ—Å—Ç–µ –ø–æ –∫–æ–ª-–≤—É –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç, –Ω–æ —Å–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ ‚Äì —á—Ç–æ –º—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏ —ç—Ç–æ —Å –ø–æ–º–æ—â—å—é –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–π `data driven` –ø–æ–¥—Ö–æ–¥ üòä
#     
# –ß—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—É—á—à–µ? üòä
#     
# </div>

# <a id="6"></a>
# ### 6. –í—ã–¥–µ–ª–∏—Ç–µ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É–ª–∏—Ü–µ –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ address

# In[22]:


df.tail(5)


# In[23]:


df2 = df['address'].str.split(', ', expand=True)
df2 = df2[1]


# In[24]:


df2


# In[25]:


df = df.join(df2)


# In[26]:


df.head(2)


# <a id="7"></a>
# ### 7. –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫ —Ç–æ–ø-10 —É–ª–∏—Ü –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ–±—ä–µ–∫—Ç–æ–≤ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è. –í–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –≤–Ω–µ—à–Ω–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏ –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å ‚Äî –≤ –∫–∞–∫–∏—Ö —Ä–∞–π–æ–Ω–∞—Ö –ú–æ—Å–∫–≤—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è —ç—Ç–∏ —É–ª–∏—Ü—ã?
# 

# In[27]:


df.info()


# In[28]:


df.columns = ['id','object_name','chain','object_type','address','number','street']


# In[29]:


df['street'].value_counts().sort_values(ascending=False).to_frame()


# –ö–∞–∫ –º—ã –≤–∏–¥–∏–º, –Ω–∞ –ø–µ—Ä–≤–æ–º –º–µ—Å—Ç–µ –æ–∫–∞–∑–∞–ª–∞—Å—å –Ω–µ —É–ª–∏—Ü–∞, –∞ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –≤–Ω—É—Ç—Ä–∏ –ú–æ—Å–∫–≤—ã. –ü–æ–ø—Ä–æ–±—É–µ–º –∏—Å–ø—Ä–∞–≤–∏—Ç—å —ç—Ç–æ.

# In[30]:


# df.groupby('street')['object_name'].count().sort_values(ascending=False).to_frame()


# In[ ]:





# –ü–æ-—Ä–∞–∑–Ω–æ–º—É –≤—ã–¥–µ–ª–∏–º —Å—Ç–æ–ª–±–µ—Ü —Å —É–ª–∏—Ü–µ–π –¥–ª—è —Ä–∞–π–æ–Ω–æ–≤ –≤–Ω—É—Ç—Ä–∏ –ú–ö–ê–î–∞ –∏ –∑–∞ –Ω–∏–º.

# In[31]:


outmkad_data = df[df['address'].str.contains('–≥–æ—Ä–æ–¥ –ó–µ–ª–µ–Ω–æ–≥—Ä–∞–¥|–ø–æ—Å–µ–ª–µ–Ω–∏–µ –°–æ—Å–µ–Ω—Å–∫–æ–µ|–ø–æ—Å–µ–ª–µ–Ω–∏–µ –ú–æ—Å–∫–æ–≤—Å–∫–∏–π|–≥–æ—Ä–æ–¥ –¢—Ä–æ–∏—Ü–∫|–≥–æ—Ä–æ–¥ –ú–æ—Å–∫–æ–≤—Å–∫–∏–π|–≥–æ—Ä–æ–¥ –©–µ—Ä–±–∏–Ω–∫–∞')]
msk_data = df[~df['address'].str.contains('–≥–æ—Ä–æ–¥ –ó–µ–ª–µ–Ω–æ–≥—Ä–∞–¥|–ø–æ—Å–µ–ª–µ–Ω–∏–µ –°–æ—Å–µ–Ω—Å–∫–æ–µ|–ø–æ—Å–µ–ª–µ–Ω–∏–µ –ú–æ—Å–∫–æ–≤—Å–∫–∏–π|–≥–æ—Ä–æ–¥ –¢—Ä–æ–∏—Ü–∫|–≥–æ—Ä–æ–¥ –ú–æ—Å–∫–æ–≤—Å–∫–∏–π|–≥–æ—Ä–æ–¥ –©–µ—Ä–±–∏–Ω–∫–∞')]

msk_data['street'] = msk_data['address'].str.split(', ', expand=True)[1]
outmkad_data['street'] = outmkad_data['address'].str.split(', ', expand=True)[2]

new_data = pd.concat([msk_data, outmkad_data])


# In[32]:


new_data


# In[33]:


top = new_data.groupby('street')['object_name'].count().sort_values(ascending=False).to_frame().head(10)


# In[34]:


top


# In[35]:


ax = top.sort_values(by='object_name').plot(title='–¢–û–ü-10 —É–ª–∏—Ü –ø–æ –∫–æ–ª-–≤—É –∑–∞–≤–µ–¥–µ–Ω–∏–π –æ–±—â. –ø–∏—Ç–∞–Ω–∏—è', kind='barh')
ax.set_xlabel("–ö–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π")
ax.set_ylabel("–£–ª–∏—Ü–∞")
plt.show()


# <div class="alert alert-success">
# <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
#     
# –í–æ–ø—Ä–æ—Å —Å–æ "–∑–≤–µ–∑–¥–æ—á–∫–æ–π" üòä:
# 
# –ö–∞–∫ —Ç—ã —Å—á–∏—Ç–∞–µ—à—å —ç—Ç–æ —Ç–æ—Ç —Å–∞–º—ã–π —Ç–æ–ø –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–º –Ω—É–∂–µ–Ω ? 
#     
# –¢–æ –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ —É–ª–∏—Ü—ã —Ç–∞–∫–∏–µ –±–æ–ª—å—à–∏–µ –∏ –ø–æ—ç—Ç–æ–º—É –≤ –Ω–∏—Ö –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –ø–∏—Ç–∞–Ω–∏—è ? 
#     
# </div>

# In[36]:


top.index


# –ò–∑ –≤–Ω–µ—à–Ω–µ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –≤–æ–∑—å–º—ë–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ —É–ª–∏—Ü, —á—Ç–æ–±—ã —Å–æ–æ—Ç–Ω–µ—Å—Ç–∏ –Ω–∞—à–∏ –∑–∞–≤–µ–¥–µ–Ω–∏—è —Å —Ä–∞–π–æ–Ω–∞–º–∏ –ú–æ—Å–∫–≤—ã.

# In[37]:


df3 = pd.read_csv('https://www.dropbox.com/s/rmraw6o3vtiwdd3/mosgaz-streets.csv?dl=1')
df3


# <div class="alert alert-success">
# <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
# 
# –ó–¥–æ—Ä–æ–≤–æ, —á—Ç–æ —Ä–∞–∑–æ–±—Ä–∞–ª–∏—Å—å –∫–∞–∫ –ø–æ–¥–∫–ª—é—á–∞—Ç—å —Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫ üòäüëèüëè
#     
# </div>

# In[38]:


df3[df3.streetname.duplicated()]['streetname'].nunique()


# 549 —É–ª–∏—Ü –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è –∏ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –±–æ–ª—å—à–µ, —á–µ–º –∫ –æ–¥–Ω–æ–º—É —Ä–∞–π–æ–Ω—É. –≠—Ç–æ –∏—Å–∫–∞–∑–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è. –¢–µ–º –Ω–µ –º–µ–Ω–µ–µ —É–¥–∞–ª–∏–º –¥—É–±–ª–∏–∫–∞—Ç—ã.

# In[39]:


df3 = df3.drop_duplicates('streetname')


# In[40]:


df3[df3.streetname.duplicated()]['streetname'].nunique()


# In[41]:


df4 = pd.DataFrame(data = df3, columns = ['streetname', 'area', 'okrug'])

df4.columns = ['street', 'district', 'okrug']
df4


# In[42]:


new_data = new_data.merge(df4, on='street')


# In[43]:


new_data.head()


# In[44]:


top = new_data.groupby(['street', 'district'])['object_name'].count().sort_values(ascending=False).to_frame().head(10)
top


# In[45]:


ax = top.plot(title='–¢–û–ü-10 —É–ª–∏—Ü –ø–æ –∫–æ–ª-–≤—É –∑–∞–≤–µ–¥–µ–Ω–∏–π –æ–±—â. –ø–∏—Ç–∞–Ω–∏—è', kind='barh')
ax.set_xlabel("–ö–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π")
ax.set_ylabel("–£–ª–∏—Ü–∞ –∏ —Ä–∞–π–æ–Ω")
plt.show()


# <div class="alert alert-success">
# <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
# 
# –•–æ—Ä–æ—à–∏–º —Ç–æ–Ω–æ–º —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö. 
#     
# –ö—Å—Ç–∞—Ç–∏ —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é:
#     
# - –≤ –±–∏–±–∏–ª–æ—Ç–µ–∫–µ `plotly` —Å –ø–æ–º–æ—â—å—é –∞—Ç—Ä–∏–±—É—Ç–∞ `text`, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ –º–µ—Ç–æ–¥–µ `px.bar`
# - –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ `matplotlib` <a href="https://queirozf.com/entries/add-labels-and-text-to-matplotlib-plots-annotation-examples">–ø–µ—Ä–≤—ã–π –ø—Ä–∏–º–µ—Ä</a>, <a href="https://matplotlib.org/stable/gallery/lines_bars_and_markers/barchart.html">–≤—Ç–æ—Ä–æ–π –ø—Ä–∏–º–µ—Ä</a> –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
#     
# </div>

# <a id="8"></a>
# ### 8. –ù–∞–π–¥–∏—Ç–µ —á–∏—Å–ª–æ —É–ª–∏—Ü —Å –æ–¥–Ω–∏–º –æ–±—ä–µ–∫—Ç–æ–º –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è. –í–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –≤–Ω–µ—à–Ω–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏ –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å ‚Äî –≤ –∫–∞–∫–∏—Ö —Ä–∞–π–æ–Ω–∞—Ö –ú–æ—Å–∫–≤—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è —ç—Ç–∏ —É–ª–∏—Ü—ã?

# In[46]:


new_data.head(2)


# In[47]:


df5 = new_data.pivot_table('object_name',['street', 'district'],aggfunc='count')[new_data.pivot_table('object_name',['street', 'district'],aggfunc='count').object_name==1]
df5.head(10)


# In[48]:


df5.reset_index()


# In[49]:


ax = df5.groupby('district')['object_name'].count().sort_values().tail(10).plot(title='–ì–¥–µ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —É–ª–∏—Ü —Å –æ–¥–Ω–∏–º –∑–∞–≤–µ–¥–µ–Ω–∏–µ–º –æ–±—â–µ–ø–∏—Ç–∞', kind='barh')
ax.set_xlabel("–ö–æ–ª-–≤–æ —É–ª–∏—Ü —Å –æ–¥–Ω–∏–º –∑–∞–≤–µ–¥–µ–Ω–∏–µ–º")
ax.set_ylabel("–†–∞–π–æ–Ω")
plt.show()


# In[50]:


print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–ª–∏—Ü —Å –æ–¥–Ω–∏–º –æ–±—ä–µ–∫—Ç–æ–º –æ–±—â–µ–ø–∏—Ç–∞:', len(new_data.pivot_table('object_name',['street', 'district'],aggfunc='count')[new_data.pivot_table('object_name',['street', 'district'],aggfunc='count').object_name==1]))


# <div class="alert alert-success">
# <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
# 
# –¢–µ–ø–µ—Ä—å –º—ã –∑–Ω–∞–µ–º –≤ –∫–∞–∫–∏—Ö —Ä–∞–π–æ–Ω–∞—Ö –º–µ–Ω—å—à–µ –≤—Å–µ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –æ–±—â–µ–ø–∏—Ç–∞.
#     
# </div>

# –ë–æ–ª—å—à–µ –≤—Å–µ–≥–æ —É–ª–∏—Ü —Å –æ–¥–Ω–∏–º –æ–±—ä–µ–∫—Ç–æ–º –æ–±—â–µ–ø–∏—Ç–∞, –∏—Å—Ö–æ–¥—è –∏–∑ –∏–º–µ—é—â–∏—Ö—Å—è –¥–∞–Ω–Ω—ã—Ö, –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –¢–∞–≥–∞–Ω—Å–∫–æ–º, –ë–∞—Å–º–∞–Ω–Ω–æ–º —Ä–∞–π–æ–Ω–∞—Ö –∏ –≤ –•–∞–º–æ–≤–Ω–∏–∫–∞—Ö.

# <a id="9"></a>
# ### 9. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç –¥–ª—è —É–ª–∏—Ü —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ–±—ä–µ–∫—Ç–æ–≤ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è. –ö–∞–∫–∏–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –≤—ã—è–≤–∏—Ç—å?

# –í—ã–±–µ—Ä–µ–º 10 —É–ª–∏—Ü, –≥–¥–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π.

# In[51]:


top = new_data.groupby(['street'])['object_name'].count().sort_values(ascending=False).to_frame().head(10).index
top


# In[52]:


new_data.head(1)


# –í—ã–±–µ—Ä–µ–º –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞ —É–ª–∏—Ü—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—Ö–æ–¥—è—Ç –≤ —Ç–æ–ø-10, –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ.

# In[53]:


ax = new_data[new_data['street'].isin(top)]['number'].hist(bins = 50, range = (0, 400))
ax.set_xlabel("–ö–æ–ª-–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç")
ax.set_ylabel("–ö–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π")
plt.show()


# In[54]:


new_data[new_data['street'].isin(top)]['number'].describe()


# –î–ª—è —É–ª–∏—Ü, –≥–¥–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ –Ω–µ–±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç: 57 –≤ —Å—Ä–µ–¥–Ω–µ–º –∏ 40 - –º–µ–¥–∏–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

# <a id="10"></a>
# ### 10. –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

# 1. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –≤ –ú–æ—Å–∫–≤–µ - –∫–∞—Ñ–µ (40%). –ó–∞ –Ω–∏–º–∏ –∏–¥—É—Ç —Å—Ç–æ–ª–æ–≤—ã–µ (17%), —Ä–µ—Å—Ç–æ—Ä–∞–Ω (15%), –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è (13%). –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –≥–æ–≤–æ—Ä–∏—Ç—å –∏ –æ —Ç–æ–º, –∫–∞–∫–∏–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑—É—é—Ç—Å—è –±–û–ª—å—à–∏–º —Å–ø—Ä–æ—Å–æ–º —É –º–æ—Å–∫–≤–∏—á–µ–π. –ü–æ—ç—Ç–æ–º—É, –≤–æ–∑–º–æ–∂–Ω–æ, —Ä–µ—à–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—å –∏–º–µ–Ω–Ω–æ –∫–∞—Ñ–µ –±—ã–ª–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º.
# 
# 2. –ü–æ–¥–∞–≤–ª—è—é—â–µ–µ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π - –Ω–µ—Å–µ—Ç–µ–≤—ã–µ (81%). –í–µ—Ä–æ—è—Ç–Ω–æ, –∏ –Ω–∞–º —Å—Ç–æ–∏—Ç –Ω–∞—á–∞—Ç—å —Å –æ–¥–Ω–æ–≥–æ –∫–∞—Ñ–µ.
# 
# 3. –ù–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ —Å–µ—Ç–µ–≤—ã–º–∏ —è–≤–ª—è—é—Ç—Å—è –∫–∞—Ñ–µ, –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã.
# 
# 4. –î–ª—è —Å–µ—Ç–µ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –æ–±—â–µ–ø–∏—Ç–∞ –∑–∞–≤–µ–¥–µ–Ω–∏–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ –º–Ω–æ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π —Å –Ω–µ–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç.
# 
# 5. –ë–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç, –ø–æ –Ω–∞—à–∏–º –¥–∞–Ω–Ω—ã–º, –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç —Å—Ç–æ–ª–æ–≤—ã–µ (32%), —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã (24%) –∏ –±—É—Ñ–µ—Ç—ã (13%).
# 
# 6. –ü—Ä–æ—Å–ø–µ–∫—Ç –ú–∏—Ä–∞, –ü—Ä–æ—Ñ—Å–æ—é–∑–Ω–∞—è —É–ª–∏—Ü–∞ –∏ –õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç –ª–∏–¥–∏—Ä—É—é—Ç –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ç–∞–º –∑–∞–≤–µ–¥–µ–Ω–∏–π. –í–æ–∑–º–æ–∂–Ω–æ, –∏ –Ω–∞–º —Å—Ç–æ–∏—Ç —Ä–∞–∑—Å–º–µ—Å—Ç–∏—Ç—å —Å–≤–æ–µ –∫–∞—Ñ–µ —Ç–∞–º.
# 
# 7. –í –¢–∞–≥–∞–Ω—Å–∫–æ–º, –ë–∞—Å–º–∞–Ω–Ω–æ–º –∏ –¢–≤–µ—Ä—Å–∫–æ–º —Ä–∞–π–æ–Ω–∞—Ö –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —É–ª–∏—Ü —Ç–æ–ª—å–∫–æ —Å –æ–¥–Ω–∏–º –∑–∞–≤–µ–¥–µ–Ω–∏–µ–º –æ–±—â–µ–ø–∏—Ç–∞. –°—Ç–æ–∏—Ç –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –º–µ—Å—Ç–æ –¥–ª—è –Ω–∞—à–µ–≥–æ –∫–∞—Ñ–µ –≤ —ç—Ç–∏—Ö —Ä–∞–π–æ–Ω–∞—Ö.
# 
# 8. –î–ª—è —É–ª–∏—Ü, –≥–¥–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ –Ω–µ–±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç: 57 –≤ —Å—Ä–µ–¥–Ω–µ–º –∏ 40 - –º–µ–¥–∏–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

# –°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é: https://disk.yandex.ru/i/b2CIc96DjfvLUQ

# <div class="alert alert-success">
# <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
# 
# –í —Ü–µ–ª–æ–º —Ä–∞–±–æ—Ç–∞ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–∞—è. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –≤ –æ–¥–Ω—É –æ–±—â—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É.
#     
# –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, —Ç–∞–º –≥–¥–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –¥–µ–π—Å—Ç–≤–∏—è –ø–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è–º –≥—Ä–∞—Ñ–∏–∫–æ–≤, —Ç–æ –µ—Å—Ç—å –æ–¥–Ω–æ—Ç–∏–ø–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏, —Ä–µ–∫–æ–º–µ–Ω–¥—É—é —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏, —á—Ç–æ–±—ã –Ω–µ –ø–∏—Å–∞—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–æ–¥ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑. –¢–µ–º —Å–∞–º—ã–º —Å–º–æ–∂–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç.
#     
# ---
#     
#     
# –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è —Å–¥–µ–ª–∞–Ω–∞ —Ö–æ—Ä–æ—à–æ, –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ—Ä–∞–¥–æ–≤–∞–ª–æ:
#     
# - –µ—ë —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ—Å—Ç—å
# - –Ω–∞—á–∏–ª–∏–µ —Ü–µ–ª–µ–π 
# - –Ω–∞–ª–∏—á–∏–µ summary –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏, –≤—Å–µ –ª—é–±—è—Ç –≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–∞–∑—É üòä
# - –≤—ã–≤–æ–¥—ã –¥–ª—è –≤—Å–µ—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
# - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
#     
# –ö–∞–∫ –µ—ë –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –µ—â—ë —É–ª—É—á—à–∏—Ç—å:
#     
# - –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞—Ç—å —Å–ª–∞–π–¥—ã
# - —Å–¥–µ–ª–∞—Ç—å –æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ
#     
# –í –æ—Å—Ç–∞–ª—å–Ω–æ–º –≤—Å—ë —á—É–¥–Ω–æüòä
#     
# –ü–æ–∑–¥—Ä–∞–≤–ª—è—é —Å —É—Å–ø–µ—à–Ω—ã–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º –ø—Ä–æ–µ–∫—Ç–∞ üòäüëç
#     
# –ò –∂–µ–ª–∞—é —É—Å–ø–µ—Ö–æ–≤ –≤ –Ω–æ–≤—ã—Ö —Ä–∞–±–æ—Ç–∞—Ö üòä
# 
# </div>

# In[ ]:




